app-id: org.gnome.gedit
runtime: org.gnome.Platform
runtime-version: '47'
sdk: org.gnome.Sdk
command: gedit

finish-args:
  - --share=ipc
  - --socket=fallback-x11
  - --socket=wayland
  - --metadata=X-DConf=migrate-path=/org/gnome/gedit/
  # Needed at least for the integrated file browser plugin:
  - --filesystem=host
  # GVfs GIO APIs access using backend URIs
  - --filesystem=xdg-run/gvfsd
  - --talk-name=org.gtk.vfs.*

cleanup:
  - /include
  - /lib/pkgconfig
  - /share/pkgconfig
  - /share/aclocal
  - /man
  - /share/man
  - /share/gtk-doc
  - /share/vala
  - /share/gir-1.0
  - '*.la'
  - '*.a'

modules:
  - name: gedit
    buildsystem: meson
    sources:
      - type: archive
        url: https://download.gnome.org/sources/gedit/48/gedit-48.0.tar.xz
        sha256: fe0fef9b7b0799120db86ae893a060036a13445352ded9169bab28d38acf0e80
        x-checker-data:
          type: gnome
          name: gedit
          stable-only: true

    modules:
      - name: gspell
        buildsystem: meson
        config-opts:
          - -Dgspell_app=false
          - -Dgobject_introspection=false
          - -Dvapi=false
          - -Dgtk_doc=false
          - -Dtests=false
          - -Dinstall_tests=false
        sources:
          - type: archive
            url: https://download.gnome.org/sources/gspell/1.14/gspell-1.14.0.tar.xz
            sha256: 64ea1d8e9edc1c25b45a920e80daf67559d1866ffcd7f8432fecfea6d0fe8897
            x-checker-data:
              type: gnome
              name: gspell
              stable-only: true

      - name: libgedit-gfls
        buildsystem: meson
        config-opts:
          - -Dgtk_doc=false
          - -Dtests=false
        sources:
          - type: archive
            url: https://download.gnome.org/sources/libgedit-gfls/0.2/libgedit-gfls-0.2.0.tar.xz
            sha256: c88bc2bbf1ec1155b61766f372ac44a7f272792234b86e8ad5ea4f7365171acb
            x-checker-data:
              type: gnome
              name: libgedit-gfls
              versions:
                <: '0.3'

      - name: libgedit-amtk
        buildsystem: meson
        config-opts:
          - -Dgtk_doc=false
          - -Dtests=false
        sources:
          - type: archive
            url: https://download.gnome.org/sources/libgedit-amtk/5.9/libgedit-amtk-5.9.0.tar.xz
            sha256: 7fc3348bef242e08967bdbb9a6698cf39f7810f95051fd8132910f36ed2d6d15
            x-checker-data:
              type: gnome
              name: libgedit-amtk
              stable-only: true

      - name: libpeas
        buildsystem: meson
        config-opts:
          - -Dlua51=false
          - -Ddemos=false
          - -Dglade_catalog=false
        sources:
          - type: archive
            url: https://download.gnome.org/sources/libpeas/1.36/libpeas-1.36.0.tar.xz
            sha256: 297cb9c2cccd8e8617623d1a3e8415b4530b8e5a893e3527bbfd1edd13237b4c
            x-checker-data:
              type: gnome
              versions:
                <: '1.37'
              name: libpeas

      - name: libgedit-gtksourceview
        buildsystem: meson
        config-opts:
          - -Dgtk_doc=false
          - -Dtests=false
        sources:
          - type: archive
            url: https://download.gnome.org/sources/libgedit-gtksourceview/299/libgedit-gtksourceview-299.3.0.tar.xz
            sha256: 5ab049520010501e78ca4a19df96e2041412756ce90a3dde0a8a1ae6d88af052
            x-checker-data:
              type: gnome
              name: libgedit-gtksourceview
              versions:
                <: '299.4'

      - name: libgedit-tepl
        buildsystem: meson
        config-opts:
          - -Dgtk_doc=false
          - -Dtests=false
        sources:
          - type: archive
            url: https://download.gnome.org/sources/libgedit-tepl/6.11/libgedit-tepl-6.11.0.tar.xz
            sha256: 30814663de8324acbbdce623ead4690ed75a9ff7c90023a04997d67e2c0121aa
            x-checker-data:
              type: gnome
              name: libgedit-tepl
              versions:
                <: '6.12'

  - name: gedit-plugins
    buildsystem: meson
    sources:
      - type: archive
        url: https://download.gnome.org/sources/gedit-plugins/48/gedit-plugins-48.0.tar.xz
        sha256: 75fb90e219d46c332b071262ca6fa1cb597b31de97db80c1879d851cf645eb98
        x-checker-data:
          type: gnome
          name: gedit-plugins
          stable-only: true

    modules:
      - name: gucharmap
        buildsystem: meson
        config-opts:
          - -Ducd_path=/app/share/unicode
        sources:
          - type: archive
            url: https://gitlab.gnome.org/GNOME/gucharmap/-/archive/16.0.2/gucharmap-16.0.2.tar.gz
            sha256: 200b0dd3276290e2d442f7ce71b9ca5dd79a0b07099f3e6b02d9b493e08ba303
            x-checker-data:
              type: anitya
              project-id: 1276
              stable-only: true
              url-template: https://gitlab.gnome.org/GNOME/gucharmap/-/archive/$version/gucharmap-$version.tar.gz
        cleanup:
          - /bin
          - /share/help
          - /share/metainfo
        modules:
          - name: unicode-character-database
            buildsystem: simple
            build-commands:
              - install -Dm644 {UCD,Unihan}.zip -t ${FLATPAK_DEST}/share/unicode/
              - bsdtar -xf UCD.zip -C ${FLATPAK_DEST}/share/unicode
              - bsdtar -xf Unihan.zip -C ${FLATPAK_DEST}/share/unicode
            sources:
              - type: file
                url: https://www.unicode.org/Public/zipped/16.0.0/UCD.zip
                sha256: c86dd81f2b14a43b0cc064aa5f89aa7241386801e35c59c7984e579832634eb2
                x-checker-data:
                  type: anitya
                  project-id: 17620
                  stable-only: true
                  url-template: https://www.unicode.org/Public/zipped/$version/UCD.zip
              - type: file
                url: https://www.unicode.org/Public/zipped/16.0.0/Unihan.zip
                sha256: b8f000df69de7828d21326a2ffea462b04bc7560022989f7cc704f10521ef3e0
                x-checker-data:
                  type: anitya
                  project-id: 17620
                  stable-only: true
                  url-template: https://www.unicode.org/Public/zipped/$version/Unihan.zip
            cleanup:
              - '*'

      - name: vte
        buildsystem: meson
        cleanup:
          - /bin
        sources:
          - type: archive
            url: https://download.gnome.org/sources/vte/0.78/vte-0.78.2.tar.xz
            sha256: 35d7bcde07356846b4a12881c8e016705b70a9004a9082285eee5834ccc49890
            x-checker-data:
              type: gnome
              name: vte
              stable-only: true
