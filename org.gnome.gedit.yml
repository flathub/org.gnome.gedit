app-id: org.gnome.gedit
runtime: org.gnome.Platform
runtime-version: '49'
sdk: org.gnome.Sdk
command: gedit

finish-args:
  - --share=ipc
  - --socket=fallback-x11
  - --socket=wayland
  - --metadata=X-DConf=migrate-path=/org/gnome/gedit/
  # Needed at least for the integrated file browser plugin:
  - --filesystem=host
  # GVfs GIO APIs access using backend URIs
  - --filesystem=xdg-run/gvfsd
  - --talk-name=org.gtk.vfs.*

cleanup:
  - /include
  - /lib/pkgconfig
  - /share/pkgconfig
  - /share/aclocal
  - /man
  - /share/man
  - /share/gtk-doc
  - /share/vala
  - /share/gir-1.0
  - '*.la'
  - '*.a'

modules:
  - name: gedit
    buildsystem: meson
    sources:
      - type: git
        url: https://gitlab.gnome.org/World/gedit/gedit.git
        tag: 49.0
        commit: 684abd8299139e1a3b87446da501ad034e78c840
        x-checker-data:
          type: git
          tag-pattern: ^49\.\d+$

    modules:
      - name: gspell
        buildsystem: meson
        config-opts:
          - -Dgspell_app=false
          - -Dgobject_introspection=false
          - -Dvapi=false
          - -Dgtk_doc=false
          - -Dtests=false
          - -Dinstall_tests=false
        sources:
          - type: git
            url: https://gitlab.gnome.org/GNOME/gspell.git
            tag: 1.14.2
            commit: 2497b987e8d013947012c1b00ac806aefb909d1c
            x-checker-data:
              type: git
              tag-pattern: ^1\.\d+\.\d+$

      - name: libgedit-gfls
        buildsystem: meson
        config-opts:
          - -Dgtk_doc=false
          - -Dtests=false
        sources:
          - type: git
            url: https://gitlab.gnome.org/World/gedit/libgedit-gfls.git
            tag: 0.3.1
            commit: 0a0c8dd29ae2f9f4a99cbaaf1628d2352953e0bc
            x-checker-data:
              type: git
              tag-pattern: ^0\.3\.\d+$

      - name: libgedit-amtk
        buildsystem: meson
        config-opts:
          - -Dgtk_doc=false
          - -Dtests=false
        sources:
          - type: git
            url: https://gitlab.gnome.org/World/gedit/libgedit-amtk.git
            tag: 5.9.2
            commit: 117f27534d74c164f7f5d0d034189688720d6630
            x-checker-data:
              type: git
              tag-pattern: ^5\.9\.\d+$

      - name: libpeas
        buildsystem: meson
        config-opts:
          - -Dlua51=false
          - -Dpython3=false
          - -Ddemos=false
          - -Dglade_catalog=false
        sources:
          - type: archive
            url: https://download.gnome.org/sources/libpeas/1.36/libpeas-1.36.0.tar.xz
            sha256: 297cb9c2cccd8e8617623d1a3e8415b4530b8e5a893e3527bbfd1edd13237b4c
            x-checker-data:
              type: gnome
              versions:
                <: '1.37'
              name: libpeas

      - name: libgedit-gtksourceview
        buildsystem: meson
        config-opts:
          - -Dgtk_doc=false
          - -Dtests=false
        sources:
          - type: git
            url: https://gitlab.gnome.org/World/gedit/libgedit-gtksourceview.git
            tag: 299.6.0
            commit: a7bdc39f9fbc10c49ea7468ac1e5bf77385da0c0
            x-checker-data:
              type: git
              tag-pattern: ^299\.6\.\d+$

      - name: libgedit-tepl
        buildsystem: meson
        config-opts:
          - -Dgtk_doc=false
          - -Dtests=false
        sources:
          - type: git
            url: https://gitlab.gnome.org/World/gedit/libgedit-tepl.git
            tag: 6.14.0
            commit: d60f7ded17b52ea42091c073ea81090e91f38620
            x-checker-data:
              type: git
              tag-pattern: ^6\.14\.\d+$

  - name: gedit-plugins
    buildsystem: meson
    sources:
      - type: git
        url: https://gitlab.gnome.org/World/gedit/gedit-plugins.git
        tag: 49.0
        commit: 3a4b4d7f11dc811ce2b4e810a23d589f6928b7c6
        x-checker-data:
          type: git
          tag-pattern: ^49\.\d+$
